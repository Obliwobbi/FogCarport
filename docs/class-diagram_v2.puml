@startuml FogCarport Class Diagram - Flat Structure
!theme plain
skinparam classAttributeIconSize 0
skinparam linetype ortho

' Color coding by architectural layer
skinparam class {
    BackgroundColor<<controller>> AliceBlue
    BorderColor<<controller>> DodgerBlue

    BackgroundColor<<service>> Honeydew
    BorderColor<<service>> ForestGreen

    BackgroundColor<<interface>> PaleGreen
    BorderColor<<interface>> SeaGreen

    BackgroundColor<<persistence>> LemonChiffon
    BorderColor<<persistence>> Goldenrod

    BackgroundColor<<entity>> White
    BorderColor<<entity>> Gray

    BackgroundColor<<dto>> LightCyan
    BorderColor<<dto>> DarkCyan

    BackgroundColor<<util>> Lavender
    BorderColor<<util>> Purple

    BackgroundColor<<config>> Wheat
    BorderColor<<config>> Orange

    BackgroundColor<<exception>> LightPink
    BorderColor<<exception>> Crimson
}

' Legend
legend top left
|= Color |= Layer |= Description |
|<back:AliceBlue>   </back>| Controller | Presentation layer - handles HTTP requests (app.controllers) |
|<back:PaleGreen>   </back>| Service Interface | Contracts for business logic (app.services) |
|<back:Honeydew>   </back>| Service Implementation | Business logic layer (app.services) |
|<back:LemonChiffon>   </back>| Persistence | Data access layer - mappers and connection pool (app.persistence) |
|<back:White>   </back>| Entity | Domain model objects (app.entities) |
|<back:LightCyan>   </back>| DTO | Data Transfer Objects (app.dto) |
|<back:Lavender>   </back>| Utility | Helper classes (app.util, app.services) |
|<back:Wheat>   </back>| Config | Configuration classes (app.config) |
|<back:LightPink>   </back>| Exception | Custom exceptions (app.exceptions) |
endlegend

' ============================================
' CONTROLLERS
' ============================================
class HomeController <<controller>>
class OrderController <<controller>>
class CarportController <<controller>>
class ContactController <<controller>>
class DrawingController <<controller>>

' ============================================
' SERVICE INTERFACES
' ============================================
interface CarportService <<interface>>
interface OrderService <<interface>>
interface CustomerService <<interface>>
interface DrawingService <<interface>>
interface CalculatorService <<interface>>
interface OrderDetailsService <<interface>>
interface SvgService <<interface>>
interface EmailService <<interface>>
interface EmployeeService <<interface>>

' ============================================
' SERVICE IMPLEMENTATIONS
' ============================================
class CarportServiceImpl <<service>>
class OrderServiceImpl <<service>>
class CustomerServiceImpl <<service>>
class DrawingServiceImpl <<service>>
class CalculatorServiceImpl <<service>>
class OrderDetailsServiceImpl <<service>>
class SvgServiceImpl <<service>>
class EmailServiceImpl <<service>>
class EmployeeServiceImpl <<service>>

' ============================================
' UTILITY CLASSES
' ============================================
class CarportTopViewSvg <<util>>
class Constants <<util>>
class Status <<util>>
class GmailEmailSenderHTML <<util>>

' ============================================
' CONFIGURATION CLASSES
' ============================================
class ThymeleafConfig <<config>>

' ============================================
' EXCEPTION CLASSES
' ============================================
class DatabaseException <<exception>>

' ============================================
' MAPPERS
' ============================================
class CustomerMapper <<persistence>>
class EmployeeMapper <<persistence>>
class MaterialMapper <<persistence>>
class OrderMapper <<persistence>>
class CarportMapper <<persistence>>
class DrawingMapper <<persistence>>
class MaterialsLinesMapper <<persistence>>
class ConnectionPool <<persistence>>

' ============================================
' DTO
' ============================================
class OrderWithDetailsDTO <<dto>>

' ============================================
' ENTITIES
' ============================================
class Customer <<entity>>
class Employee <<entity>>
class Carport <<entity>>
class Drawing <<entity>>
class Order <<entity>>
class MaterialsLine <<entity>>
class Material <<entity>>

' ============================================
' ENTITY DOMAIN RELATIONSHIPS
' ============================================
Order "1" *-- "1" Drawing : contains
Order "1" *-- "1" Carport : contains
Order "1" *-- "0..*" MaterialsLine : has
MaterialsLine "0..*" *-- "1" Material : uses

Order "0..*" -- "1" Customer : placed by
Order "0..*" -- "0..1" Employee : managed by

' ============================================
' DTO COMPOSITION
' ============================================
OrderWithDetailsDTO "1" o-- "1" Drawing
OrderWithDetailsDTO "1" o-- "1" Carport
OrderWithDetailsDTO "1" o-- "1" Customer
OrderWithDetailsDTO "1" o-- "0..1" Employee
OrderWithDetailsDTO "1" o-- "0..*" MaterialsLine

' ============================================
' CONTROLLER → SERVICE DEPENDENCIES
' ============================================
' HomeController - no service dependencies (only renders static page)

ContactController ..> CustomerService : uses
ContactController ..> OrderService : uses
ContactController ..> DrawingService : uses
ContactController ..> CarportService : uses

CarportController ..> CarportService : uses

DrawingController ..> DrawingService : uses
DrawingController ..> CalculatorService : uses
DrawingController ..> OrderService : uses

OrderController ..> OrderService : uses
OrderController ..> OrderDetailsService : uses
OrderController ..> EmailService : uses
OrderController ..> EmployeeService : uses
OrderController ..> CarportService : uses
OrderController ..> CustomerService : uses

' ============================================
' SERVICE INTERFACE IMPLEMENTATIONS
' ============================================
CarportService <|.. CarportServiceImpl : implements
OrderService <|.. OrderServiceImpl : implements
CustomerService <|.. CustomerServiceImpl : implements
DrawingService <|.. DrawingServiceImpl : implements
CalculatorService <|.. CalculatorServiceImpl : implements
OrderDetailsService <|.. OrderDetailsServiceImpl : implements
SvgService <|.. SvgServiceImpl : implements
EmailService <|.. EmailServiceImpl : implements
EmployeeService <|.. EmployeeServiceImpl : implements

' ============================================
' SERVICE → MAPPER DEPENDENCIES
' ============================================
' Carport Service
CarportServiceImpl ..> CarportMapper : uses
CarportServiceImpl ..> Constants : uses

' Order Service
OrderServiceImpl ..> OrderMapper : uses

' Customer Service
CustomerServiceImpl ..> CustomerMapper : uses

' Drawing Service
DrawingServiceImpl ..> DrawingMapper : uses
DrawingServiceImpl ..> SvgService : uses
DrawingServiceImpl ..> CalculatorService : uses
DrawingServiceImpl ..> CarportTopViewSvg : uses

' Order Details Service
OrderDetailsServiceImpl ..> MaterialsLinesMapper : uses
OrderDetailsServiceImpl ..> MaterialMapper : uses
OrderDetailsServiceImpl ..> CalculatorService : uses

' Calculator Service
CalculatorServiceImpl ..> Carport : uses
CalculatorServiceImpl ..> Constants : uses

' SVG Service
' SvgServiceImpl has no external dependencies

' Employee Service
EmployeeServiceImpl ..> EmployeeMapper : uses

' Email Service
EmailServiceImpl ..> GmailEmailSenderHTML : uses

' ============================================
' MAPPER → ENTITY CREATION
' ============================================
CustomerMapper ..> Customer : <<creates>>
EmployeeMapper ..> Employee : <<creates>>
CarportMapper ..> Carport : <<creates>>
DrawingMapper ..> Drawing : <<creates>>
OrderMapper ..> Order : <<creates>>
MaterialMapper ..> Material : <<creates>>
MaterialsLinesMapper ..> MaterialsLine : <<creates>>

' OrderMapper internally uses MaterialsLinesMapper
OrderMapper ..> MaterialsLinesMapper : uses

' ============================================
' MAPPER → DATABASE CONNECTION
' ============================================
CustomerMapper ..> ConnectionPool : uses
EmployeeMapper ..> ConnectionPool : uses
CarportMapper ..> ConnectionPool : uses
DrawingMapper ..> ConnectionPool : uses
OrderMapper ..> ConnectionPool : uses
MaterialMapper ..> ConnectionPool : uses
MaterialsLinesMapper ..> ConnectionPool : uses

' ============================================
' UTILITY AND CONFIG DEPENDENCIES
' ============================================
CarportTopViewSvg ..> Carport : uses
CarportTopViewSvg ..> CalculatorService : uses
CarportTopViewSvg ..> SvgService : uses
CarportTopViewSvg ..> Constants : uses

CarportServiceImpl ..> Constants : uses
OrderDetailsServiceImpl ..> Constants : uses

GmailEmailSenderHTML ..> ThymeleafConfig : uses

Order ..> Status : uses
OrderWithDetailsDTO ..> Status : uses

@enduml

